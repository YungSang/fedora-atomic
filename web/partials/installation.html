<article>
  <div class="container">
    <div class="starter-template">
      <h3>Trying a preconfigured virtual machine</h3>
      <p>If you just want to experiment with complete safety, there
	are automatically and continuously generated VM images for
	each tree.
      </p>
      <p><a class="btn btn-lg btn-primary" href="http://rpm-ostree.cloud.fedoraproject.org/images/auto">Download QEMU disks</a></p>
      <p>
	A recommended starting point is the <tt>base/core</tt> VM.
	Download and provision in virt-manager by:
	<pre>
	  cd /var/lib/libvirt/images
	  curl http://rpm-ostree.cloud.fedoraproject.org/images/auto/fedostree-rawhide-x86_64-buildmaster-base-core/latest-qcow2.xz | xz -d > fedostree-base-core.qcow2
	</pre>
	Then using e.g. <tt>virt-manager</tt>, choose "Import existing disk image".
      </p>
      <h3>Installing inside an existing OS</h3>
      <p>First, you should understand what you'll be doing here.  OSTree
	allows dynamically parallel installing operating systems;
	(almost) all of its data goes in the new toplevel
	directory <tt>/ostree</tt>.  At the end you will have a dual
	boot.
      </p>
      <p>These instructions are oriented for users of Fedora, but OSTree
	itself can be packaged and used on top of any existing GNU/Linux
	distribution.</p>
      <p>Install the ostree package, and make sure you have ostree 2014.1
	or newer (presently in Bodhi updates-testing).</p>
      <pre>
	yum install ostree
      </pre>
      <p>
	This bit of one time initialization will both
	create <tt>/ostree</tt> for you, as well
	as <tt>/ostree/deploy/fedostree</tt>.  Only a few directories are
	created, we haven't really affected the system much yet.
      </p>
      <pre>
	ostree admin os-init fedostree
      </pre>
      <p>This step tells OSTree how to find the repository you built on
	the server.  You only need to do this once.</p>
      <pre>
	ostree remote add --set=gpg-verify=false fedostree http://rpm-ostree.cloud.fedoraproject.org/repo
      </pre>
      <p>We still have only initialized configuration.  This next step
	will just download (but not install) a system with just <tt>@standard</tt> plus <tt>docker-io</tt>:</p>
      <pre>
	ostree pull fedostree fedostree/20/x86_64/server/docker-io
      </pre>
      <p>This step extracts the root filesystem, and updates the bootloader
	configuration:</p>
      <pre>
	ostree admin deploy --os=fedostree --karg-proc-cmdline --karg=selinux=0 fedostree:fedostree/20/x86_64/server/docker-io
      </pre>
      <p>Now, we need to copy in the storage configuration from the "host":</p>
      <pre>
	cp /etc/fstab /ostree/deploy/fedostree/current/etc
      </pre>
      <h3 id="booting">Booting the system</h3>
      <p>Your system now contains <b>both</b> a traditional Fedora install
	and an OSTree root.  There is no impact on your installed system
	except for additional disk space in the <tt>/boot/loader</tt> and <tt>/ostree</tt>
	directories.
      </p>
      <p>At the GRUB prompt, instead of choosing one of the two listed
	entries, press <tt>c</tt> to get a command line.  Now, enter:</p>
      <pre>
	bls_import
      </pre>
      <p>Then press <tt>Esc</tt>.  You should have an additional boot menu entry,
	named <tt>ostree:fedora:0</tt>.  Nagivate to it and press <tt>Enter</tt>.</p>
      
      <p>Log in to the VM as <b>root</b> - there is no password.</p>
    </div>
  </div>
</article>
